# Установка зависимостей (раскомментируй при необходимости)
# !pip install torch fpdf sentence-transformers faiss-cpu --quiet

import torch
import torch.nn as nn
from fpdf import FPDF
from sentence_transformers import SentenceTransformer
import faiss
import numpy as np
import os
import textwrap

# Онтология: по 50 элементов на каждый блок
ontology = {
    'goal': [
    {"short": "Оптимизация расходов на аренду",
     "description": "Оптимизация расходов на аренду медных линий снижает постоянные издержки компании, сохраняя качество связи.",
     "metrics": "Финансовые отчёты и сравнительный анализ затрат."},
    {"short": "Повышение надёжности связи",
     "description": "Повышение надёжности достигается за счёт модернизации и своевременного обслуживания инфраструктуры.",
     "metrics": "Отчёты о сбоях, статистика времени простоя, отзывы пользователей."},
    {"short": "Внедрение автоматизированного мониторинга",
     "description": "Автоматизация мониторинга позволяет своевременно выявлять неисправности и снижать время реакции на инциденты.",
     "metrics": "Логи мониторинговых систем, время реакции на инциденты."},
    {"short": "Снижение времени простоев",
     "description": "Минимизация времени простоев за счёт оптимизации процессов ремонта и обслуживания.",
     "metrics": "Отчёты о времени простоя, показатели SLA."},
    {"short": "Обеспечение безопасности данных",
     "description": "Обеспечение защиты данных при передаче по медным линиям и предотвращение утечек информации.",
     "metrics": "Отчёты по безопасности, аудиты информационной безопасности."},
    {"short": "Повышение энергоэффективности",
     "description": "Снижение энергопотребления оборудования при сохранении производительности.",
     "metrics": "Отчёты по энергопотреблению, показатели эффективности."},
    {"short": "Сокращение зависимости от аренды",
     "description": "Уменьшение доли арендованных линий за счёт развития собственной инфраструктуры.",
     "metrics": "Данные о доле собственных и арендованных линий."},
    {"short": "Повышение качества обслуживания клиентов",
     "description": "Улучшение пользовательского опыта за счёт повышения стабильности и скорости связи.",
     "metrics": "Оценки удовлетворённости клиентов, жалобы и отзывы."},
    {"short": "Модернизация устаревших участков",
     "description": "Обновление оборудования и кабельной сети для повышения эффективности работы.",
     "metrics": "Отчёты о замене оборудования, техническое состояние сети."},
    {"short": "Интеграция с цифровыми сервисами",
     "description": "Связь медных линий с современными цифровыми платформами и IoT.",
     "metrics": "Данные о подключениях, показатели использования сервисов."},
    {"short": "Оптимизация маршрутизации трафика",
     "description": "Повышение эффективности распределения трафика для сокращения задержек и потерь.",
     "metrics": "Логи сетевого оборудования, показатели качества связи."},
    {"short": "Повышение автоматизации процессов",
     "description": "Внедрение автоматических систем управления и мониторинга для снижения ручного труда.",
     "metrics": "Отчёты по внедрению автоматизации, показатели производительности."},
    {"short": "Обеспечение нормативного соответствия",
     "description": "Соблюдение всех действующих стандартов и регуляторных требований в сфере связи.",
     "metrics": "Аудиты соответствия, сертификаты качества."},
    {"short": "Снижение операционных рисков",
     "description": "Минимизация рисков сбоев и аварий через комплексные меры безопасности и контроля.",
     "metrics": "Статистика сбоев, отчёты о мерах безопасности."},
    {"short": "Повышение квалификации персонала",
     "description": "Обучение сотрудников новым технологиям и стандартам работы.",
     "metrics": "Протоколы тренингов, оценки эффективности обучения."},
    {"short": "Оптимизация технической поддержки",
     "description": "Улучшение процессов поддержки для сокращения времени решения инцидентов.",
     "metrics": "Время обработки заявок, отзывы клиентов."},
    {"short": "Расширение покрытия сети",
     "description": "Увеличение географического охвата для повышения доступности услуг.",
     "metrics": "Карта покрытия, данные о подключениях."},
    {"short": "Снижение затрат на обслуживание",
     "description": "Оптимизация расходов на техническое обслуживание и ремонт инфраструктуры.",
     "metrics": "Финансовые отчёты, сравнение затрат по периодам."},
    {"short": "Внедрение новых технологий",
     "description": "Использование современных технологий для повышения эффективности и качества связи.",
     "metrics": "Отчёты по проектам, показатели производительности."},
    {"short": "Повышение устойчивости к внешним воздействиям",
     "description": "Защита инфраструктуры от погодных и технических воздействий.",
     "metrics": "Отчёты о происшествиях, состояние оборудования."},
    {"short": "Сокращение времени простоев",
     "description": "Минимизация длительности отключений и простоев сети.",
     "metrics": "Отчёты о времени простоя, SLA."},
    {"short": "Обеспечение резервирования каналов",
     "description": "Создание резервных путей для обеспечения бесперебойной связи.",
     "metrics": "Документация по резервированию, отчёты о работе резервов."},
    {"short": "Улучшение процессов инвентаризации",
     "description": "Автоматизация и оптимизация учёта оборудования и материалов.",
     "metrics": "Отчёты по инвентаризации, данные учётных систем."},
    {"short": "Оптимизация использования ресурсов",
     "description": "Эффективное распределение технических и людских ресурсов.",
     "metrics": "Отчёты об использовании ресурсов, анализ загрузки."},
    {"short": "Повышение прозрачности управления",
     "description": "Улучшение контроля и мониторинга процессов управления инфраструктурой.",
     "metrics": "Отчёты менеджмента, показатели KPI."},
    {"short": "Сокращение времени на согласование решений",
     "description": "Оптимизация процессов принятия решений для повышения скорости реализации проектов.",
     "metrics": "Время согласований, протоколы совещаний."},
    {"short": "Развитие корпоративной культуры",
     "description": "Формирование культуры качества и ответственности среди сотрудников.",
     "metrics": "Оценки внутреннего климата, результаты опросов."},
    {"short": "Улучшение взаимодействия с подрядчиками",
     "description": "Оптимизация коммуникаций и контроля качества у подрядных организаций.",
     "metrics": "Отчёты по взаимодействию, оценки качества работ."},
    {"short": "Сокращение времени внедрения новшеств",
     "description": "Ускорение процессов адаптации и внедрения новых технологий.",
     "metrics": "План-графики, отчёты о внедрении."},
    {"short": "Повышение качества технической документации",
     "description": "Стандартизация и улучшение документации для эффективной работы.",
     "metrics": "Результаты аудитов документации, отзывы пользователей."},
    {"short": "Обеспечение безопасности персонала",
     "description": "Создание безопасных условий труда при работе с инфраструктурой.",
     "metrics": "Отчёты по охране труда, показатели травматизма."},
    {"short": "Разработка стратегии модернизации",
     "description": "Формирование долгосрочной стратегии развития инфраструктуры.",
     "metrics": "Документы стратегии, планы реализации."},
    {"short": "Снижение издержек на логистику",
     "description": "Оптимизация доставки и складирования материалов и оборудования.",
     "metrics": "Отчёты по логистике, анализ затрат."},
    {"short": "Повышение уровня автоматизации",
     "description": "Максимальное использование автоматических систем для повышения эффективности.",
     "metrics": "Отчёты по автоматизации, показатели производительности."},
    {"short": "Обеспечение соответствия нормативам",
     "description": "Соблюдение требований законодательства и стандартов отрасли.",
     "metrics": "Результаты проверок, сертификаты."},
    {"short": "Сокращение аварийных ситуаций",
     "description": "Предупреждение и минимизация количества аварий и сбоев.",
     "metrics": "Статистика аварий, отчёты службы эксплуатации."},
    {"short": "Улучшение качества обслуживания абонентов",
     "description": "Повышение качества услуг и поддержки клиентов.",
     "metrics": "Опросы удовлетворённости, жалобы и отзывы."},
    {"short": "Оптимизация расходов на энергию",
     "description": "Снижение затрат на электроэнергию при эксплуатации оборудования.",
     "metrics": "Отчёты по энергопотреблению, анализ затрат."},
    {"short": "Увеличение пропускной способности сети",
     "description": "Расширение возможностей передачи данных по существующей инфраструктуре.",
     "metrics": "Технические отчёты, мониторинг трафика."},
    {"short": "Повышение квалификации персонала",
     "description": "Проведение обучения и повышения компетенций сотрудников.",
     "metrics": "Отчёты о тренингах, результаты аттестаций."},
    {"short": "Снижение времени обслуживания",
     "description": "Уменьшение времени выполнения технических работ и ремонтов.",
     "metrics": "Отчёты по ремонтам, показатели времени восстановления."},
    {"short": "Повышение устойчивости сети",
     "description": "Обеспечение непрерывной работы сети при различных нагрузках и авариях.",
     "metrics": "Тесты отказоустойчивости, отчёты о простоях."},
    {"short": "Внедрение системы контроля качества",
     "description": "Создание механизмов контроля качества услуг и процессов.",
     "metrics": "Аудит процессов, отчёты по качеству."},
    {"short": "Обеспечение защиты от киберугроз",
     "description": "Реализация мер по защите сетевой инфраструктуры от внешних атак.",
     "metrics": "Отчёты по безопасности, результаты тестирований."},
    {"short": "Оптимизация процессов документооборота",
     "description": "Упрощение и автоматизация обработки документов.",
     "metrics": "Отчёты о документообороте, показатели времени обработки."},
    {"short": "Повышение эффективности использования ресурсов",
     "description": "Рациональное использование оборудования и материалов.",
     "metrics": "Отчёты по использованию ресурсов, анализ складских остатков."},
    {"short": "Разработка планов аварийного восстановления",
     "description": "Создание процедур и планов на случай аварий и сбоев.",
     "metrics": "Документы планирования, результаты учений."},
    {"short": "Сокращение времени согласования решений",
     "description": "Оптимизация процессов утверждения проектов и изменений.",
     "metrics": "Протоколы согласований, время прохождения документов."},
    {"short": "Повышение уровня цифровизации",
     "description": "Расширение использования цифровых технологий в управлении сетью.",
     "metrics": "Отчёты по цифровым проектам, внедрение IT-решений."},
    {"short": "Улучшение взаимодействия с клиентами",
     "description": "Оптимизация каналов связи и поддержки пользователей.",
     "metrics": "Оценки качества клиентской поддержки, отзывы."},
    {"short": "Повышение прозрачности финансовых потоков",
     "description": "Улучшение учёта и контроля финансовых операций.",
     "metrics": "Финансовая отчётность, аудит."},
    {"short": "Снижение влияния внешних факторов",
     "description": "Минимизация рисков, связанных с погодными и другими воздействиями.",
     "metrics": "Отчёты об авариях, мониторинг окружающей среды."},
    {"short": "Повышение скорости принятия решений",
     "description": "Сокращение времени реакции руководства на возникающие проблемы.",
     "metrics": "Отчёты по управлению, показатели времени принятия решений."}
],
    'outcome': [
    {"short": "Прекращение аренды неиспользуемых каналов",
     "description": "Успешное расторжение договоров аренды для неактивных и устаревших медных линий, что привело к снижению расходов.",
     "metrics": "Подписанные акты расторжения, финансовые отчёты о снижении затрат."},
    {"short": "Обновление базы активных пользователей",
     "description": "Актуализация и поддержка в актуальном состоянии базы данных активных пользователей и подключённых линий.",
     "metrics": "Результаты аудитов базы данных, отчёты по актуализации."},
    {"short": "Внедрение системы оповещений о сбоях",
     "description": "Запуск автоматизированной системы оперативного уведомления о проблемах и авариях в сети.",
     "metrics": "Логи системы оповещений, время реакции на инциденты."},
    {"short": "Повышение загрузки действующих линий",
     "description": "Оптимизация использования активных каналов с увеличением их пропускной способности и загрузки.",
     "metrics": "Статистика использования каналов, показатели загрузки сети."},
    {"short": "Сокращение времени реакции на инциденты",
     "description": "Уменьшение времени между выявлением сбоя и его устранением благодаря автоматизации процессов.",
     "metrics": "Отчёты службы поддержки, метрики времени решения инцидентов."},
    {"short": "Увеличение доли автоматизированного мониторинга",
     "description": "Расширение охвата автоматизированных систем контроля состояния линий и оборудования.",
     "metrics": "Отчёты по мониторингу, доля автоматизированных проверок."},
    {"short": "Снижение затрат на аренду и обслуживание",
     "description": "Обеспечение уменьшения расходов на аренду и техническое обслуживание за счёт оптимизации процессов.",
     "metrics": "Финансовые отчёты, сравнительный анализ затрат."},
    {"short": "Рост удовлетворённости пользователей",
     "description": "Повышение уровня удовлетворённости клиентов за счёт улучшения качества и стабильности связи.",
     "metrics": "Опросы пользователей, показатели NPS."},
    {"short": "Сокращение времени простоев оборудования",
     "description": "Уменьшение длительности простоев за счёт оперативного реагирования и профилактики неисправностей.",
     "metrics": "Отчёты о времени простоев, статистика ремонтов."},
    {"short": "Повышение уровня резервирования каналов",
     "description": "Обеспечение наличия резервных линий для поддержания бесперебойной работы сети.",
     "metrics": "Документация по резервированию, отчёты о работе резервов."},
    {"short": "Расширение географии обслуживания",
     "description": "Увеличение территории, покрываемой качественной медной связью без существенного роста затрат.",
     "metrics": "Карты покрытия, данные по новым подключённым точкам."},
    {"short": "Повышение прозрачности учета инфраструктуры",
     "description": "Обеспечение полного и актуального учёта всех элементов инфраструктуры и их состояния.",
     "metrics": "Базы данных, результаты аудитов."},
    {"short": "Оптимизация маршрутизации трафика",
     "description": "Повышение эффективности передачи данных за счёт улучшения распределения нагрузки по каналам.",
     "metrics": "Логи маршрутизаторов, показатели пропускной способности."},
    {"short": "Увеличение скорости устранения неисправностей",
     "description": "Сокращение времени реагирования на поломки и их исправления благодаря автоматизации процессов.",
     "metrics": "Время реагирования, статистика устранения проблем."},
    {"short": "Рост доли модернизированного оборудования",
     "description": "Повышение процента использования современного и надежного технического оборудования в сети.",
     "metrics": "Отчёты о модернизации, техническое состояние."},
    {"short": "Улучшение взаимодействия с подрядчиками",
     "description": "Оптимизация процессов совместной работы с подрядными организациями для повышения качества обслуживания.",
     "metrics": "Отчёты о сотрудничестве, оценки качества работ."},
    {"short": "Повышение автоматизации технической поддержки",
     "description": "Внедрение IT-систем для автоматической обработки заявок и мониторинга состояния сети.",
     "metrics": "Отчёты по автоматизации, показатели эффективности поддержки."},
    {"short": "Сокращение времени согласования договоров",
     "description": "Оптимизация процессов утверждения и подписания договоров аренды и обслуживания.",
     "metrics": "Статистика времени согласования, протоколы совещаний."},
    {"short": "Увеличение прозрачности финансовых потоков",
     "description": "Обеспечение прозрачного учёта и контроля всех финансовых операций по проектам.",
     "metrics": "Финансовая отчётность, результаты аудитов."},
    {"short": "Рост показателей энергоэффективности",
     "description": "Снижение энергопотребления оборудования без ухудшения качества услуг.",
     "metrics": "Отчёты по энергопотреблению, анализ расходов."},
    {"short": "Сокращение количества аварийных отключений",
     "description": "Уменьшение частоты и длительности аварийных ситуаций благодаря профилактике и мониторингу.",
     "metrics": "Статистика аварий, время простоя."},
    {"short": "Повышение качества обслуживания абонентов",
     "description": "Улучшение работы службы поддержки и скорости решения проблем клиентов.",
     "metrics": "Оценки удовлетворённости, количество жалоб."},
    {"short": "Снижение затрат на внеплановые ремонты",
     "description": "Оптимизация планового технического обслуживания для минимизации внеплановых работ.",
     "metrics": "Отчёты по ремонтам, финансовые показатели."},
    {"short": "Увеличение доли использования собственных линий",
     "description": "Снижение зависимости от арендованных каналов за счёт увеличения собственной инфраструктуры.",
     "metrics": "Отчёты по структуре использования линий."},
    {"short": "Оптимизация затрат на логистику и поставки",
     "description": "Снижение расходов на транспортировку оборудования и материалов для обслуживания сети.",
     "metrics": "Отчёты по логистике, анализ затрат."},
    {"short": "Расширение функционала систем мониторинга",
     "description": "Добавление новых возможностей для контроля состояния оборудования и линий связи.",
     "metrics": "Отчёты по использованию систем, статистика сбоев."},
    {"short": "Повышение уровня безопасности сети",
     "description": "Внедрение мер защиты от киберугроз и физического воздействия на инфраструктуру.",
     "metrics": "Аудиты безопасности, отчёты о инцидентах."},
    {"short": "Сокращение времени обработки заявок",
     "description": "Уменьшение времени от поступления запроса до его обработки и решения.",
     "metrics": "Метрики службы поддержки, отчёты по заявкам."},
    {"short": "Повышение квалификации технического персонала",
     "description": "Проведение обучающих мероприятий и сертификаций для сотрудников.",
     "metrics": "Отчёты по обучению, результаты тестирований."},
    {"short": "Оптимизация процессов документооборота",
     "description": "Автоматизация и упрощение работы с документацией и отчетностью.",
     "metrics": "Отчёты по документообороту, показатели времени обработки."},
    {"short": "Увеличение скорости внедрения инноваций",
     "description": "Сокращение времени от разработки до практического применения новых технологий.",
     "metrics": "Планы проектов, отчёты о внедрении."},
    {"short": "Повышение прозрачности процессов управления",
     "description": "Обеспечение доступа к информации и контроля на всех этапах управления инфраструктурой.",
     "metrics": "Отчёты менеджмента, внутренние аудиты."},
    {"short": "Улучшение контроля качества услуг",
     "description": "Внедрение системы оценки и повышения качества предоставляемых сервисов.",
     "metrics": "Аудит качества, отзывы клиентов."},
    {"short": "Снижение рисков простоя сети",
     "description": "Минимизация влияния технических и организационных факторов на работу сети.",
     "metrics": "Статистика сбоев, отчёты о восстановлении."},
    {"short": "Расширение возможностей аналитики данных",
     "description": "Внедрение инструментов сбора и анализа больших данных для принятия решений.",
     "metrics": "Отчёты по аналитике, внедрение BI-систем."},
    {"short": "Повышение эффективности взаимодействия с поставщиками",
     "description": "Оптимизация контрактных отношений и процессов закупок.",
     "metrics": "Отчёты по закупкам, оценки работы поставщиков."},
    {"short": "Оптимизация расходов на техническое обслуживание",
     "description": "Сокращение затрат за счёт профилактики и рационального планирования работ.",
     "metrics": "Финансовые отчёты, показатели выполненных работ."},
    {"short": "Сокращение времени планирования проектов",
     "description": "Уменьшение длительности подготовки и согласования проектов модернизации.",
     "metrics": "Планы проектов, отчёты о сроках."},
    {"short": "Повышение удовлетворённости сотрудников",
     "description": "Создание условий для эффективной работы и мотивации персонала.",
     "metrics": "Опросы, показатели текучести кадров."},
    {"short": "Улучшение взаимодействия между отделами",
     "description": "Оптимизация коммуникаций и совместной работы внутри организации.",
     "metrics": "Оценки сотрудников, результаты совместных проектов."},
    {"short": "Сокращение негативного влияния внешних факторов",
     "description": "Принятие мер для защиты сети от погодных и техногенных воздействий.",
     "metrics": "Отчёты о происшествиях, мониторинг окружающей среды."},
    {"short": "Обеспечение своевременного обновления оборудования",
     "description": "Планирование и проведение модернизации с учётом сроков эксплуатации.",
     "metrics": "Планы обновления, отчёты по заменам."},
    {"short": "Повышение скорости реагирования на обращения клиентов",
     "description": "Оптимизация каналов и процессов поддержки для быстрого решения проблем.",
     "metrics": "Время обработки обращений, оценки клиентов."},
    {"short": "Улучшение системы учёта и контроля",
     "description": "Внедрение современных систем для учета активов и контроля процессов.",
     "metrics": "Отчёты по учёту, внутренние аудиты."},
    {"short": "Сокращение затрат на обучение персонала",
     "description": "Оптимизация программ обучения и повышения квалификации.",
     "metrics": "Финансовые отчёты, показатели эффективности обучения."},
    {"short": "Повышение качества технической поддержки",
     "description": "Улучшение компетенций и оснащения службы поддержки.",
     "metrics": "Отзывы клиентов, время решения проблем."},
    {"short": "Развитие инфраструктуры резервирования",
     "description": "Создание и поддержка резервных каналов для обеспечения устойчивости сети.",
     "metrics": "Документация по резервированию, отчёты о тестированиях."},
    {"short": "Оптимизация распределения ресурсов",
     "description": "Рациональное планирование использования оборудования и персонала.",
     "metrics": "Отчёты по ресурсам, показатели загрузки."},
    {"short": "Повышение качества технической документации",
     "description": "Стандартизация и обновление технической документации для эффективной работы.",
     "metrics": "Аудиты документации, оценки пользователей."},
    {"short": "Снижение времени реакции на внештатные ситуации",
     "description": "Обеспечение быстрой и эффективной реакции на аварии и сбои.",
     "metrics": "Отчёты по инцидентам, время устранения."},
    {"short": "Увеличение доли цифровых процессов",
     "description": "Автоматизация и цифровизация ключевых операционных процессов.",
     "metrics": "Отчёты по внедрению ИТ-решений, показатели автоматизации."},
    {"short": "Сокращение количества жалоб клиентов",
     "description": "Улучшение качества услуг и поддержки для снижения негативных отзывов.",
     "metrics": "Статистика жалоб, опросы клиентов."},
    {"short": "Повышение эффективности управления проектами",
     "description": "Оптимизация планирования, контроля и реализации проектов модернизации.",
     "metrics": "Отчёты по проектам, показатели выполнения сроков."},
    {"short": "Улучшение контроля затрат",
     "description": "Обеспечение прозрачности и контроля всех расходов в проектах.",
     "metrics": "Финансовые отчёты, внутренние аудиты."}
],
    'indicator': [
    {"short": "Экономия бюджета не менее 15%",
     "description": "Достижение снижения затрат на аренду и обслуживание минимум на 15% за отчётный период.",
     "metrics": "Финансовые отчёты, сравнительный анализ затрат по периодам."},
    {"short": "Снижение аварийных отключений на 30%",
     "description": "Уменьшение количества аварий и сбоев в работе сети на 30% благодаря профилактике и мониторингу.",
     "metrics": "Статистика аварий, время простоя, отчёты службы эксплуатации."},
    {"short": "Среднее время реакции на инциденты менее 1 часа",
     "description": "Среднее время реагирования на сетевые инциденты не превышает одного часа.",
     "metrics": "Отчёты по инцидентам, журналы службы поддержки."},
    {"short": "Повышение удовлетворённости клиентов на 20%",
     "description": "Увеличение уровня удовлетворённости клиентов на 20% за счёт улучшения качества услуг.",
     "metrics": "Результаты опросов клиентов, индекс NPS."},
    {"short": "Рост доли активно используемых каналов на 15%",
     "description": "Увеличение количества каналов, используемых по максимуму, на 15%.",
     "metrics": "Аналитика использования каналов, отчёты по загрузке."},
    {"short": "Снижение затрат на энергию на 10%",
     "description": "Сокращение расходов на электроэнергию, потребляемую оборудованием, минимум на 10%.",
     "metrics": "Отчёты по энергопотреблению, счётчики."},
    {"short": "Доля автоматизированных проверок более 80%",
     "description": "Более 80% проверок состояния оборудования выполняется автоматически.",
     "metrics": "Отчёты систем мониторинга, статистика проверок."},
    {"short": "Сокращение времени ремонта на 25%",
     "description": "Сокращение времени устранения неисправностей на 25% за счёт оптимизации процессов.",
     "metrics": "Отчёты по ремонтам, показатели времени простоя."},
    {"short": "Увеличение доли современного оборудования",
     "description": "Повышение доли оборудования, соответствующего современным стандартам, в инфраструктуре.",
     "metrics": "Отчёты по модернизации, технические паспорта оборудования."},
    {"short": "Положительный тренд отказоустойчивости",
     "description": "Улучшение показателей отказоустойчивости сети и оборудования с каждым кварталом.",
     "metrics": "Отчёты по отказам, статистика восстановлений."},
    {"short": "Рост количества успешно обработанных инцидентов",
     "description": "Увеличение числа инцидентов, обработанных в рамках SLA и без повторных обращений.",
     "metrics": "Отчёты службы поддержки, статистика инцидентов."},
    {"short": "Снижение количества жалоб на 40%",
     "description": "Уменьшение жалоб пользователей на качество услуг на 40%.",
     "metrics": "Анализ обращений, отчёты клиентской поддержки."},
    {"short": "Рост показателей энергоэффективности",
     "description": "Увеличение эффективности использования электроэнергии на 15%.",
     "metrics": "Отчёты по энергопотреблению, технические замеры."},
    {"short": "Увеличение прозрачности финансовых потоков",
     "description": "Обеспечение полной прозрачности и учёта всех финансовых операций.",
     "metrics": "Финансовые отчёты, аудиторские заключения."},
    {"short": "Сокращение времени согласования договоров",
     "description": "Уменьшение времени согласования договоров аренды и обслуживания на 30%.",
     "metrics": "Протоколы согласований, временные отчёты."},
    {"short": "Повышение скорости внедрения новых технологий",
     "description": "Сокращение времени от выбора технологии до её интеграции в сеть.",
     "metrics": "Планы проектов, отчёты по внедрению."},
    {"short": "Сокращение операционных расходов",
     "description": "Снижение операционных затрат на 15% за счёт оптимизации процессов.",
     "metrics": "Финансовые отчёты, сравнительный анализ."},
    {"short": "Увеличение прозрачности учёта оборудования",
     "description": "Обеспечение полного и актуального учёта всех активов компании.",
     "metrics": "Инвентаризационные отчёты, базы данных."},
    {"short": "Сокращение времени на обработку заявок",
     "description": "Уменьшение среднего времени от получения заявки до её закрытия на 25%.",
     "metrics": "Журналы заявок, отчёты службы поддержки."},
    {"short": "Увеличение доли цифровых процессов",
     "description": "Рост использования цифровых и автоматизированных процессов в работе сети.",
     "metrics": "Отчёты по цифровизации, IT-системы."},
    {"short": "Снижение времени простоев",
     "description": "Уменьшение среднего времени простоя оборудования и каналов на 20%.",
     "metrics": "Отчёты по времени простоя, журналы аварий."},
    {"short": "Увеличение покрытия сети",
     "description": "Расширение зоны покрытия качественной медной связью на 10%.",
     "metrics": "Карты покрытия, данные мониторинга."},
    {"short": "Повышение эффективности использования ресурсов",
     "description": "Оптимизация загрузки оборудования и линий для максимальной отдачи.",
     "metrics": "Отчёты по загрузке, показатели производительности."},
    {"short": "Снижение количества внеплановых ремонтов",
     "description": "Уменьшение числа аварийных ремонтов за счёт профилактических мероприятий.",
     "metrics": "Отчёты по ремонтам, статистика инцидентов."},
    {"short": "Увеличение доли резервных каналов",
     "description": "Повышение уровня резервирования для обеспечения отказоустойчивости.",
     "metrics": "Документация по резервированию, отчёты о тестах."},
    {"short": "Рост количества обученных сотрудников",
     "description": "Увеличение числа специалистов с актуальными навыками и сертификатами.",
     "metrics": "Отчёты об обучении, результаты аттестаций."},
    {"short": "Сокращение времени выполнения проектов",
     "description": "Уменьшение длительности реализации проектов по модернизации и оптимизации.",
     "metrics": "Планы и отчёты проектов, показатели выполнения."},
    {"short": "Улучшение качества технической документации",
     "description": "Повышение полноты и актуальности технических документов.",
     "metrics": "Аудиты документации, отзывы пользователей."},
    {"short": "Повышение степени автоматизации мониторинга",
     "description": "Рост доли процессов мониторинга, выполняемых автоматически.",
     "metrics": "Отчёты по автоматизации, логи систем."},
    {"short": "Сокращение времени реагирования на инциденты",
     "description": "Уменьшение времени от обнаружения проблемы до начала её устранения.",
     "metrics": "Метрики службы поддержки, журналы событий."},
    {"short": "Увеличение прозрачности процессов управления",
     "description": "Обеспечение видимости и контроля на всех этапах управления инфраструктурой.",
     "metrics": "Отчёты по управлению, внутренние аудиты."},
    {"short": "Снижение количества ошибок в операциях",
     "description": "Уменьшение числа технических и управленческих ошибок.",
     "metrics": "Отчёты по качеству, анализ инцидентов."},
    {"short": "Повышение скорости внедрения ИТ-решений",
     "description": "Сокращение времени интеграции новых технологий и систем.",
     "metrics": "Отчёты по проектам, временные показатели."},
    {"short": "Рост показателей безопасности сети",
     "description": "Увеличение уровня защиты от киберугроз и физического воздействия.",
     "metrics": "Аудиты безопасности, отчёты по инцидентам."},
    {"short": "Увеличение прозрачности финансовых операций",
     "description": "Обеспечение прозрачного и контролируемого движения средств.",
     "metrics": "Финансовая отчётность, внутренние аудиты."},
    {"short": "Снижение времени согласования процессов",
     "description": "Уменьшение времени, необходимого для утверждения проектов и изменений.",
     "metrics": "Протоколы совещаний, временные метрики."},
    {"short": "Повышение уровня цифровизации процессов",
     "description": "Расширение использования цифровых инструментов в управлении сетью.",
     "metrics": "Отчёты по цифровизации, использование IT-систем."},
    {"short": "Увеличение эффективности работы персонала",
     "description": "Повышение производительности и качества работы сотрудников.",
     "metrics": "Оценки эффективности, показатели KPI."},
    {"short": "Сокращение затрат на техническую поддержку",
     "description": "Оптимизация расходов на обслуживание и поддержку инфраструктуры.",
     "metrics": "Финансовые отчёты, анализ затрат."},
    {"short": "Рост скорости обработки заявок клиентов",
     "description": "Уменьшение среднего времени реакции на обращения пользователей.",
     "metrics": "Отчёты службы поддержки, метрики обработки заявок."},
    {"short": "Повышение качества обслуживания пользователей",
     "description": "Улучшение работы клиентских сервисов и поддержки.",
     "metrics": "Опросы клиентов, показатели удовлетворённости."},
    {"short": "Увеличение использования современных технологий",
     "description": "Расширение доли современных решений и оборудования в инфраструктуре.",
     "metrics": "Отчёты по модернизации, техническая документация."},
    {"short": "Снижение количества внеплановых простоев",
     "description": "Минимизация незапланированных перерывов в работе сети.",
     "metrics": "Журналы сбоев, отчёты технических служб."},
    {"short": "Увеличение прозрачности процессов инвентаризации",
     "description": "Обеспечение полного и актуального учёта активов компании.",
     "metrics": "Отчёты по инвентаризации, данные учётных систем."},
    {"short": "Сокращение времени реагирования на аварии",
     "description": "Уменьшение времени обнаружения и устранения аварийных ситуаций.",
     "metrics": "Отчёты по инцидентам, мониторинг работ."},
    {"short": "Повышение прозрачности управления проектами",
     "description": "Обеспечение контроля и видимости на всех этапах проектов.",
     "metrics": "Отчёты по управлению, внутренние проверки."},
    {"short": "Рост показателей энергоэффективности",
     "description": "Снижение энергозатрат без потери качества услуг.",
     "metrics": "Отчёты по энергопотреблению, технические измерения."},
    {"short": "Улучшение процессов документооборота",
     "description": "Оптимизация и цифровизация работы с документацией.",
     "metrics": "Отчёты по документообороту, показатели времени обработки."},
    {"short": "Сокращение операционных рисков",
     "description": "Минимизация рисков, связанных с техническими и организационными сбоями.",
     "metrics": "Анализ инцидентов, отчёты службы безопасности."},
    {"short": "Повышение качества технической поддержки",
     "description": "Улучшение компетенций и процессов в службе поддержки пользователей.",
     "metrics": "Отзывы клиентов, показатели скорости обработки обращений."},
    {"short": "Увеличение степени резервирования",
     "description": "Рост числа резервных решений для обеспечения устойчивости сети.",
     "metrics": "Документация по резервированию, результаты тестов."}
],
    'risk': [
    {"short": "Недостаточное финансирование",
     "description": "Риск нехватки бюджета для реализации проектов модернизации и оптимизации сети.",
     "metrics": "Планирование бюджета, отчёты финансового отдела, контроль исполнения бюджета."},
    {"short": "Юридические сложности с расторжением договоров",
     "description": "Возможные задержки и споры при прекращении аренды с контрагентами.",
     "metrics": "Юридические заключения, мониторинг статуса договоров, отчёты юридического отдела."},
    {"short": "Износ оборудования",
     "description": "Риск отказа техники и кабельной сети из-за устаревания и физического износа.",
     "metrics": "Технические проверки, отчёты по техническому состоянию и ремонту."},
    {"short": "Сопротивление персонала изменениям",
     "description": "Возможные проблемы с адаптацией сотрудников к новым технологиям и процессам.",
     "metrics": "Опросы персонала, отчёты HR, показатели вовлечённости."},
    {"short": "Ошибки в данных и учёте",
     "description": "Недостоверные или устаревшие данные об инфраструктуре, приводящие к неправильным решениям.",
     "metrics": "Аудиты данных, результаты сверок баз данных."},
    {"short": "Задержки в поставках оборудования",
     "description": "Проблемы с логистикой и задержки поставок, влияющие на сроки проектов.",
     "metrics": "Отчёты по закупкам, сроки поставок, контроль логистики."},
    {"short": "Влияние погодных условий",
     "description": "Повреждения и сбои в работе из-за неблагоприятных природных факторов.",
     "metrics": "Отчёты об авариях, мониторинг погодных условий."},
    {"short": "Риски безопасности данных",
     "description": "Угроза утечки или повреждения информации при передаче и хранении данных.",
     "metrics": "Аудиты информационной безопасности, отчёты о инцидентах."},
    {"short": "Недостаточная квалификация персонала",
     "description": "Недостаток компетенций у сотрудников для эффективного обслуживания и развития сети.",
     "metrics": "Аттестация, результаты обучения, анализ квалификаций."},
    {"short": "Проблемы интеграции новых технологий",
     "description": "Сложности с внедрением современных решений в существующую инфраструктуру.",
     "metrics": "Отчёты по внедрению, показатели совместимости систем."},
    {"short": "Сбой системы мониторинга",
     "description": "Перебои или ошибки в работе систем контроля, ведущие к непредвиденным инцидентам.",
     "metrics": "Логи мониторинговых систем, отчёты о сбоях."},
    {"short": "Рост эксплуатационных расходов",
     "description": "Увеличение затрат выше запланированных из-за непредвиденных факторов.",
     "metrics": "Финансовые отчёты, анализ отклонений бюджета."},
    {"short": "Непредвиденные технические неисправности",
     "description": "Аварии и сбои, возникающие без предварительного предупреждения.",
     "metrics": "Статистика инцидентов, отчёты технических служб."},
    {"short": "Влияние вандализма и аварий",
     "description": "Повреждения инфраструктуры по вине третьих лиц или вследствие аварийных ситуаций.",
     "metrics": "Отчёты полиции, отчёты аварийных служб."},
    {"short": "Задержки в управленческих решениях",
     "description": "Снижение эффективности из-за медленных решений руководства.",
     "metrics": "Протоколы заседаний, временные показатели согласования."},
    {"short": "Неправильная оценка рисков",
     "description": "Ошибки при анализе и прогнозировании потенциальных угроз.",
     "metrics": "Аналитические отчёты, результаты аудитов рисков."},
    {"short": "Потеря ключевых сотрудников",
     "description": "Уход опытных специалистов, приводящий к снижению качества работы.",
     "metrics": "Отчёты HR, текучесть кадров."},
    {"short": "Неэффективное управление проектами",
     "description": "Сбой в планировании и контроле проектов, ведущий к срывам сроков и бюджета.",
     "metrics": "Отчёты по проектам, анализ исполнения сроков."},
    {"short": "Риски кибератак",
     "description": "Угрозы нарушения работы сети и безопасности данных из-за внешних атак.",
     "metrics": "Отчёты по безопасности, результаты тестирований и аудитов."},
    {"short": "Несоответствие нормативным требованиям",
     "description": "Риски штрафов и санкций за нарушение законодательства и стандартов.",
     "metrics": "Результаты проверок, сертификаты соответствия."},
    {"short": "Проблемы с лицензированием",
     "description": "Наличие или утрата необходимых лицензий для работы и обслуживания.",
     "metrics": "Документы лицензирования, проверки регуляторов."},
    {"short": "Отсутствие резервного финансирования",
     "description": "Риски при недостатке финансовых резервов для срочных работ и аварий.",
     "metrics": "Финансовые отчёты, планирование резервов."},
    {"short": "Низкая мотивация персонала",
     "description": "Снижение производительности из-за недостатка мотивационных программ.",
     "metrics": "Опросы сотрудников, показатели эффективности."},
    {"short": "Неадекватное планирование",
     "description": "Ошибки в планировании проектов, приводящие к перерасходу ресурсов и времени.",
     "metrics": "Отчёты планирования, анализ отклонений."},
    {"short": "Сложности в коммуникации",
     "description": "Проблемы взаимодействия между подразделениями и с подрядчиками.",
     "metrics": "Отчёты о коммуникациях, оценки командной работы."},
    {"short": "Недостаток ресурсов",
     "description": "Отсутствие необходимых технических, человеческих или финансовых ресурсов.",
     "metrics": "Отчёты о ресурсах, показатели загрузки."},
    {"short": "Ошибки при внедрении технологий",
     "description": "Неудачи и сбои при интеграции новых систем и решений.",
     "metrics": "Отчёты о внедрении, анализ инцидентов."},
    {"short": "Перебои в поставках материалов",
     "description": "Задержки и перебои в снабжении необходимыми материалами и оборудованием.",
     "metrics": "Отчёты по закупкам, мониторинг поставок."},
    {"short": "Нарушение графиков работ",
     "description": "Срывы сроков выполнения плановых и внеплановых работ.",
     "metrics": "Журналы работ, отчёты о выполнении проектов."},
    {"short": "Недостаток технической поддержки",
     "description": "Низкий уровень сервисной поддержки и обслуживания оборудования.",
     "metrics": "Отзывы клиентов, показатели SLA."},
    {"short": "Проблемы с качеством услуг",
     "description": "Снижение качества связи и сервисов, вызывающее жалобы клиентов.",
     "metrics": "Анализ жалоб, мониторинг качества."},
    {"short": "Отсутствие обновлений ПО",
     "description": "Риски использования устаревших версий программного обеспечения.",
     "metrics": "Журналы обновлений, отчёты IT-службы."},
    {"short": "Ошибки при документообороте",
     "description": "Нарушения и неточности в документообороте, влияющие на процессы.",
     "metrics": "Аудиты документооборота, проверки внутреннего контроля."},
    {"short": "Недостаточная автоматизация процессов",
     "description": "Ручной труд, повышающий вероятность ошибок и замедляющий работу.",
     "metrics": "Отчёты по автоматизации, показатели производительности."},
    {"short": "Потеря данных",
     "description": "Риски утраты или повреждения критически важных данных.",
     "metrics": "Резервное копирование, отчёты по инцидентам."},
    {"short": "Сложности с масштабированием",
     "description": "Трудности при расширении инфраструктуры под растущие потребности.",
     "metrics": "Планы развития, отчёты о масштабировании."},
    {"short": "Конфликты интересов",
     "description": "Внутренние конфликты, влияющие на качество управления и принятие решений.",
     "metrics": "Отчёты HR, внутренние расследования."},
    {"short": "Низкая вовлечённость персонала",
     "description": "Отсутствие заинтересованности сотрудников в результатах работы.",
     "metrics": "Опросы сотрудников, показатели участия."},
    {"short": "Недостаточный контроль качества",
     "description": "Отсутствие эффективных механизмов контроля, приводящее к ошибкам.",
     "metrics": "Аудиты, отчёты по качеству."},
    {"short": "Перегрузка систем",
     "description": "Риски сбоев из-за превышения пропускной способности оборудования.",
     "metrics": "Мониторинг нагрузки, отчёты о сбоях."},
    {"short": "Непредвиденные внешние факторы",
     "description": "Влияние форс-мажоров, природных и техногенных катастроф.",
     "metrics": "Отчёты о происшествиях, страховые акты."},
    {"short": "Нарушение нормативных требований",
     "description": "Риски штрафов и санкций за несоблюдение законов и стандартов.",
     "metrics": "Результаты проверок, внутренние аудиты."},
    {"short": "Недостаточная подготовка к авариям",
     "description": "Отсутствие эффективных планов и тренировок по аварийному восстановлению.",
     "metrics": "Документы планирования, результаты учений."},
    {"short": "Низкая адаптивность к изменениям рынка",
     "description": "Трудности с быстрым реагированием на изменения в отрасли и спросе.",
     "metrics": "Аналитика рынка, отчёты по адаптации."},
    {"short": "Проблемы с лицензированием",
     "description": "Отсутствие или потеря необходимых лицензий для деятельности.",
     "metrics": "Документы лицензирования, отчёты регуляторов."},
    {"short": "Ошибки при оценке технического состояния",
     "description": "Неверные оценки, приводящие к неправильному планированию ремонтов и модернизаций.",
     "metrics": "Отчёты по обследованиям, результаты аудитов."},
    {"short": "Нарушения в цепочке поставок",
     "description": "Проблемы с получением комплектующих и материалов вовремя и в полном объёме.",
     "metrics": "Отчёты по закупкам, мониторинг поставок."},
    {"short": "Несоблюдение стандартов качества",
     "description": "Отсутствие контроля за соответствием услуг и процессов установленным нормам.",
     "metrics": "Аудиты, отчёты по качеству."},
    {"short": "Зависимость от одного поставщика",
     "description": "Риски при потере доступа к ключевому поставщику услуг или оборудования.",
     "metrics": "Данные контрактов, оценки риска."},
    {"short": "Потеря критической информации",
     "description": "Утрата важных данных из-за сбоев, ошибок или кибератак.",
     "metrics": "Логи безопасности, отчёты инцидентов."},
    {"short": "Отсутствие резервного копирования",
     "description": "Риск потери данных без возможности восстановления из-за отсутствия резервных копий.",
     "metrics": "Планы резервного копирования, отчёты IT-службы."},
    {"short": "Низкое качество технического обслуживания",
     "description": "Неэффективное или несвоевременное обслуживание оборудования, приводящее к сбоям.",
     "metrics": "Отчёты по техническому обслуживанию, показатели отказов."},
    {"short": "Недостаток коммуникации с клиентами",
     "description": "Отсутствие своевременного информирования и поддержки пользователей.",
     "metrics": "Отзывы клиентов, анализ обращений."},
    {"short": "Ошибки при внедрении новых технологий",
     "description": "Проблемы и сбои, вызванные неправильной интеграцией инноваций.",
     "metrics": "Отчёты по проектам, анализ инцидентов."}
]
}

# Для демонстрации — повторяем первые два элемента каждого блока до 50 (заглушка)
for block in ontology:
    base = ontology[block]
    while len(base) < 50:
        base.append(base[len(base) % 2].copy())

# Собираем все short-формулировки для embeddings и поиска
all_phrases = []
index_map = {}
start_idx = 0
for block in ['goal', 'outcome', 'indicator', 'risk']:
    phrases = [item['short'] for item in ontology[block]]
    end_idx = start_idx + len(phrases)
    index_map[block] = (start_idx, end_idx)
    all_phrases.extend(phrases)
    start_idx = end_idx

# Создаём эмбеддинги
model_st = SentenceTransformer('all-MiniLM-L6-v2')
embeddings = model_st.encode(all_phrases)
embeddings = np.array(embeddings).astype('float32')

# Инициализация FAISS
faiss_index = faiss.IndexFlatL2(embeddings.shape[1])
faiss_index.add(embeddings)

# GAN генератор (MLP)
class Generator(nn.Module):
    def __init__(self):
        super().__init__()
        self.net = nn.Sequential(
            nn.Linear(16, 64),
            nn.ReLU(),
            nn.Linear(64, 64),
            nn.ReLU(),
            nn.Linear(64, 4)
        )
    def forward(self, z):
        return self.net(z)

gen = Generator()

# RAG-коррекция: выбирает индексы по GAN выходу
def rag_correct(gan_output):
    corrected_indices = []
    for i, block in enumerate(['goal', 'outcome', 'indicator', 'risk']):
        start, end = index_map[block]
        idx = int(abs(gan_output[i].item())) % (end - start) + start
        corrected_indices.append(idx)
    return corrected_indices

# PDF с поддержкой кириллицы и форматированием
class PDF(FPDF):
    def __init__(self):
        super().__init__()
        font_path = "/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf"
        if not os.path.isfile(font_path):
            font_path = "DejaVuSans.ttf"  # Положи рядом с кодом
        self.add_font('DejaVu', '', font_path, uni=True)

    def chapter_title(self, title):
        self.set_font('DejaVu', 'B', 14)
        self.cell(0, 10, title, 0, 1, 'L')
        self.ln(4)

    def chapter_body(self, description, metrics):
        self.set_font('DejaVu', '', 12)
        for paragraph in [description, f"Инструменты проверки: {metrics}"]:
            wrapped = textwrap.fill(paragraph, 100)
            self.multi_cell(0, 8, wrapped)
            self.ln(3)

def create_pdf(detailed_entries, filename="logframe_detailed.pdf"):
    pdf = PDF()
    pdf.add_page()
    headers = ['Цель', 'Результат', 'Индикатор', 'Риск']
    for header, entry in zip(headers, detailed_entries):
        pdf.chapter_title(header)
        pdf.chapter_body(entry['description'], entry['metrics'])
    pdf.output(filename)
    print(f"PDF создан: {filename}")

def main():
    _ = input("Введите тему проекта (можно пропустить): ")
    print("Генерируем GAN-выход...")
    z = torch.randn(1, 16)
    gan_out = gen(z).detach()[0]
    print(f"GAN output: {gan_out}")

    print("Делаем RAG-коррекцию...")
    indices = rag_correct(gan_out)

    detailed_entries = []
    blocks = ['goal', 'outcome', 'indicator', 'risk']
    for i, block in enumerate(blocks):
        idx = indices[i] - index_map[block][0]
        entry = ontology[block][idx]
        detailed_entries.append(entry)

    print("\nРезультаты генерации:\n")
    for block_name, entry in zip(blocks, detailed_entries):
        print(f"{block_name.upper()}:")
        print(f"- {entry['short']}")
        print(f"  {entry['description']}")
        print(f"  Инструменты проверки: {entry['metrics']}\n")

    create_pdf(detailed_entries)

if __name__ == "__main__":
    main()
